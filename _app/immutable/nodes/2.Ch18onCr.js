import{t as w,a as L,c as Ae}from"../chunks/ShRlSRrh.js";import{i as Q}from"../chunks/C4lPoHSt.js";import{$ as Ne,i as Ee,A as D,l as S,a0 as Ie,x as Le,g as x,N as G,y as Se,z as re,B as H,m as T,ad as we,C as fe,j as ue,D as ye,ap as Y,ah as de,a2 as te,aq as xe,F as K,ar as ae,as as Ce,at as Ve,ag as Be,au as Re,k as $e,av as Oe,aw as Te,ab as Me,a8 as Fe,ax as Ue,ay as Pe,az as ze,aA as De,aj as he,aB as He,p as Z,s as N,v as A,w as I,t as $,q as X,J as ne,o as U,aC as Ye,aD as se}from"../chunks/D-K9HiIO.js";import{p as oe,i as B,s as P,a as ee,b as Je}from"../chunks/DbvTTcjW.js";import{o as je,w as z}from"../chunks/75HYu9UQ.js";import{l as Ge,s as R,e as q}from"../chunks/C1qIrR1b.js";function Ke(r,e){return e}function qe(r,e,t,a){for(var n=[],o=e.length,s=0;s<o;s++)Ve(e[s].e,n,!0);var i=o>0&&n.length===0&&t!==null;if(i){var c=t.parentNode;Be(c),c.append(t),a.clear(),C(r,e[0].prev,e[o-1].next)}Re(n,()=>{for(var v=0;v<o;v++){var l=e[v];i||(a.delete(l.k),C(r,l.prev,l.next)),$e(l.e,!i)}})}function We(r,e,t,a,n,o=null){var s=r,i={flags:e,items:new Map,first:null};{var c=r;s=S?D(Ie(c)):c.appendChild(Ne())}S&&Le();var v=null,l=!1,p=G(()=>{var f=t();return Fe(f)?f:f==null?[]:de(f)});Ee(()=>{var f=x(p),k=f.length;if(l&&k===0)return;l=k===0;let u=!1;if(S){var m=s.data===Se;m!==(k===0)&&(s=re(),D(s),H(!1),u=!0)}if(S){for(var b=null,h,_=0;_<k;_++){if(T.nodeType===8&&T.data===we){s=T,u=!0,H(!1);break}var y=f[_],d=a(y,_);h=ge(T,i,b,null,y,d,_,n,e,t),i.items.set(d,h),b=h}k>0&&D(re())}S||Qe(f,i,s,n,e,a,t),o!==null&&(k===0?v?fe(v):v=ue(()=>o(s)):v!==null&&ye(v,()=>{v=null})),u&&H(!0),x(p)}),S&&(s=T)}function Qe(r,e,t,a,n,o,s){var i=r.length,c=e.items,v=e.first,l=v,p,f=null,k=[],u=[],m,b,h,_;for(_=0;_<i;_+=1){if(m=r[_],b=o(m,_),h=c.get(b),h===void 0){var y=l?l.e.nodes_start:t;f=ge(y,e,f,f===null?e.first:f.next,m,b,_,a,n,s),c.set(b,f),k=[],u=[],l=f.next;continue}if(Ze(h,m,_),(h.e.f&Y)!==0&&fe(h.e),h!==l){if(p!==void 0&&p.has(h)){if(k.length<u.length){var d=u[0],g;f=d.prev;var E=k[0],V=k[k.length-1];for(g=0;g<k.length;g+=1)ie(k[g],d,t);for(g=0;g<u.length;g+=1)p.delete(u[g]);C(e,E.prev,V.next),C(e,f,E),C(e,V,d),l=d,f=V,_-=1,k=[],u=[]}else p.delete(h),ie(h,l,t),C(e,h.prev,h.next),C(e,h,f===null?e.first:f.next),C(e,f,h),f=h;continue}for(k=[],u=[];l!==null&&l.k!==b;)(l.e.f&Y)===0&&(p??(p=new Set)).add(l),u.push(l),l=l.next;if(l===null)continue;h=l}k.push(h),f=h,l=h.next}if(l!==null||p!==void 0){for(var O=p===void 0?[]:de(p);l!==null;)(l.e.f&Y)===0&&O.push(l),l=l.next;var me=O.length;if(me>0){var be=i===0?t:null;qe(e,O,be,c)}}te.first=e.first&&e.first.e,te.last=f&&f.e}function Ze(r,e,t,a){xe(r.v,e),r.i=t}function ge(r,e,t,a,n,o,s,i,c,v){var l=(c&Oe)!==0,p=(c&Te)===0,f=l?p?K(n):ae(n):n,k=(c&Ce)===0?s:ae(s),u={i:k,v:f,k:o,a:null,e:null,prev:t,next:a};try{return u.e=ue(()=>i(r,f,k,v),S),u.e.prev=t&&t.e,u.e.next=a&&a.e,t===null?e.first=u:(t.next=u,t.e.next=u.e),a!==null&&(a.prev=u,a.e.prev=u.e),u}finally{}}function ie(r,e,t){for(var a=r.next?r.next.e.nodes_start:t,n=e?e.e.nodes_start:t,o=r.e.nodes_start;o!==a;){var s=Me(o);n.before(o),o=s}}function C(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}const le=[...` 	
\r\fÂ \v\uFEFF`];function Xe(r,e,t){var a=""+r;if(t){for(var n in t)if(t[n])a=a?a+" "+n:n;else if(a.length)for(var o=n.length,s=0;(s=a.indexOf(n,s))>=0;){var i=s+o;(s===0||le.includes(a[s-1]))&&(i===a.length||le.includes(a[i]))?a=(s===0?"":a.substring(0,s))+a.substring(i+1):s=i}}return a===""?null:a}function er(r,e,t,a,n,o){var s=r.__className;if(S||s!==t||s===void 0){var i=Xe(t,a,o);(!S||i!==r.getAttribute("class"))&&(i==null?r.removeAttribute("class"):r.className=i),r.__className=t}else if(o&&n!==o)for(var c in o){var v=!!o[c];(n==null||v!==!!n[c])&&r.classList.toggle(c,v)}return o}const rr=Symbol("is custom element"),tr=Symbol("is html");function F(r,e,t,a){var n=ar(r);S&&(n[e]=r.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&r.nodeName==="LINK")||n[e]!==(n[e]=t)&&(e==="loading"&&(r[Ue]=t),t==null?r.removeAttribute(e):typeof t!="string"&&nr(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function ar(r){return r.__attributes??(r.__attributes={[rr]:r.nodeName.includes("-"),[tr]:r.namespaceURI===Pe})}var ce=new Map;function nr(r){var e=ce.get(r.nodeName);if(e)return e;ce.set(r.nodeName,e=[]);for(var t,a=r,n=Element.prototype;n!==a;){t=De(a);for(var o in t)t[o].set&&e.push(o);a=ze(a)}return e}function ke(r,e,t){if(r.multiple)return ir(r,e);for(var a of r.options){var n=M(a);if(He(n,e)){a.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function sr(r,e){he(()=>{var t=new MutationObserver(()=>{var a=r.__value;ke(r,a)});return t.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function or(r,e,t=e){var a=!0;Ge(r,"change",n=>{var o=n?"[selected]":":checked",s;if(r.multiple)s=[].map.call(r.querySelectorAll(o),M);else{var i=r.querySelector(o)??r.querySelector("option:not([disabled])");s=i&&M(i)}t(s)}),he(()=>{var n=e();if(ke(r,n,a),a&&n===void 0){var o=r.querySelector(":checked");o!==null&&(n=M(o),t(n))}r.__value=n,a=!1}),sr(r)}function ir(r,e){for(var t of r.options)t.selected=~e.indexOf(M(t))}function M(r){return"__value"in r?r.__value:r.value}const pe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAAAAACPAi4CAAABH0lEQVRYw2NgGAVUArGNZIBYJAPa/pMB2kYNGDVg1IBRA0YNGDVg1IARacCO6KQdFBjwcpI1C6v11JfkGvC4QoWFgYFFvfoxmQYkCTGBJJmE48ky4KoNM0ya2eoqyQbc7VNnRMgzak68S5oBZzNlGJHbgYwy6WdJMWCvpyB6U1LA8xDxBszUYsNsjLLpzCHWgFoJRmzNWUbxSqIMOBLPj6tFzBd7hLABi5zYcbep2Z3nEzDgZaUmE75WOaN62WN8BhyPEiPUsBeLPoXbgEOunIS7BhxO+3EY8HKDAXG9C811L7EZcLxYnNj+iVjBEUwD1vnzE9/D4fNeiW7AfFNOUvpIHEazUA3ok2QmrZfFLN6JbIAdC+kdNRa70c4qtQAA7m/LhSePmzgAAAAASUVORK5CYII=",_e={faviconSize:24,faviconFetchServiceURL:r=>`https://t2.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${r}&size=${_e.faviconSize}`};async function lr(){const e="/bk"+"/bookmarks";try{const t=await fetch(e+"/index.json");if(t){const a=await t.json();if(Array.isArray(a)?a.length>0:!1){const s=a.sort().map(i=>fetch(e+"/"+i+".json").then(c=>c.json()).then(c=>(c.bookmarkIndexName=i,c)));return await Promise.all(s)}}}catch(t){console.error("bookmarks folder or bookmarks/index.json not found. Error:",t)}}async function cr(r){const e={};if(Array.isArray(r)?r.length>0:!1)for(let a=0;a<r.length;a++){const n=r[a],o=n.LINK,s=n.ICON;let i="";if(s)i=s;else if(o){const c=new URL(o),v=c.protocol+"//"+c.hostname;i=_e.faviconFetchServiceURL(v)}else i=pe;n.bookmarkIndexName&&(e[n.bookmarkIndexName]=i)}return e}var vr=w('<div class="bk-title svelte-1lplrkt"> </div>'),fr=w('<div class="bk-desc svelte-1lplrkt"> </div>'),ur=w('<a class="bk svelte-1lplrkt" target="_blank" rel="noopener noreferrer"><div class="bk-meta svelte-1lplrkt"><div class="bk-icon svelte-1lplrkt"><img alt="icon" width="100%" height="100%" loading="lazy"></div> <div class="bk-meta-info svelte-1lplrkt"><div class="bk-name svelte-1lplrkt"> </div> <div class="bk-link svelte-1lplrkt"> </div></div></div> <!> <!></a>');function dr(r,e){Z(e,!1);let t=oe(e,"bookmark",8),a=oe(e,"faviconLink",8);const n=t().LINK||"javascript:void(0)";let o=t().NAME||t().LINK;function s(d){const g=d==null?void 0:d.target;g&&(g.src=pe)}Q();var i=ur();F(i,"href",n),F(i,"title",o);var c=N(i),v=N(c),l=N(v);A(v);var p=I(v,2),f=N(p),k=N(f,!0);A(f);var u=I(f,2),m=N(u,!0);A(u),A(p),A(c);var b=I(c,2);{var h=d=>{var g=vr(),E=N(g,!0);A(g),$(()=>R(E,t().TITLE)),L(d,g)};B(b,d=>{t().TITLE&&d(h)})}var _=I(b,2);{var y=d=>{var g=fr(),E=N(g,!0);A(g),$(()=>R(E,t().DESC)),L(d,g)};B(_,d=>{t().DESC&&d(y)})}A(i),$(()=>{F(i,"data-bookmark-icon",t().ICON),F(l,"src",a()),R(k,t().NAME),R(m,t().LINK)}),q("error",l,s),L(r,i),X()}var hr=w('<div class="bookmark-container svelte-1k3hbth" id="bookmark-container"></div>');function gr(r,e){Z(e,!1);let t=K([]),a=K({});async function n(){const s=await lr();s&&ne(t,s)}je(async()=>{await n();const s=await cr(x(t));s&&ne(a,s)}),Q();var o=hr();We(o,5,()=>x(t),Ke,(s,i)=>{var c=Ae(),v=U(c);{var l=p=>{dr(p,{get bookmark(){return x(i)},get faviconLink(){return x(a)[x(i).bookmarkIndexName]}})};B(v,p=>{x(i).bookmarkIndexName&&p(l)})}L(s,c)}),A(o),L(r,o),X()}const W=z("home"),J=z(null),j=z(null);var kr=w('<div class="header svelte-1btxz3n"><a class="brand svelte-1btxz3n" href="https://m9j.github.io/bookmarks"></a> <select class="view-list" id="view-list"><option>Home</option><option>Settings</option></select></div>');function pr(r){const[e,t]=ee(),a=()=>P(W,"$selectedPage",e);var n=kr(),o=N(n);o.textContent="BOOKMARKS";var s=I(o,2);$(()=>{a(),Ye(()=>{})});var i=N(s);i.value=i.__value="home";var c=I(i);c.value=c.__value="settings",A(s),A(n),or(s,a,v=>Je(W,v)),L(r,n),t()}function _r(){navigator.serviceWorker.getRegistrations().then(r=>{r.forEach(e=>e.unregister()),console.log("All service workers have been unregistered."),caches.keys().then(e=>Promise.all(e.map(t=>caches.delete(t)))).then(()=>{console.log("All caches have been cleared."),location.reload()})})}function ve(r){if(r){const e=new Date(Number(r)),t=String(e.getFullYear()),a=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),o=e.getHours()*3600+e.getMinutes()*60+e.getSeconds(),s=String(o).padStart(5,"0");return`${t}.${a}${n}.${s}`}}async function mr(){const r="/version.json";try{const e=await fetch(r);if(!e.ok)console.log(new Error("Failed to fetch current version"));else return(await e.json()).version}catch(e){console.error("Current version check failed: ",e)}}async function br(){const r="https://api.github.com/repos/m9j/bookmarks/contents/version.json?ref=gh-pages";try{const e=await fetch(r,{cache:"no-store"});if(!e.ok)console.log(new Error("Failed to fetch latest version"));else{const t=await e.json();return JSON.parse(atob(t.content)).version}}catch(e){console.error("Latest version check failed: ",e)}}var Ar=w(" <br>",1),Nr=w("<span> </span><br>",1),Er=w("<div>Versions:<br> <!> <!></div>"),Ir=w('<div class="settings-container hide svelte-1fprsh6" id="settings-container"><!> <button class="settings-button svelte-1fprsh6">Check for latest version</button> <button class="settings-button svelte-1fprsh6">Hard reload application</button></div>');function Lr(r,e){Z(e,!1);const[t,a]=ee(),n=()=>P(J,"$currentVersion",t),o=()=>P(j,"$latestVersion",t);i();const s=z(!1);async function i(){const u=await mr();J.update(m=>u)}async function c(){const u=await br();j.update(m=>u),s.update(m=>Number(j)>Number(J))}Q();var v=Ir(),l=N(v);{var p=u=>{var m=Er(),b=I(N(m),3);{var h=d=>{var g=Ar(),E=U(g);se(),$(V=>R(E,`${V??""} [CURRENT] `),[()=>ve(n())],G),L(d,g)};B(b,d=>{n()&&d(h)})}var _=I(b,2);{var y=d=>{var g=Nr(),E=U(g);er(E,1,"svelte-1fprsh6",null,{},{"is-new":s});var V=N(E);A(E),se(),$(O=>R(V,`${O??""} [LATEST]`),[()=>ve(o())],G),L(d,g)};B(_,d=>{o()&&d(y)})}A(m),L(u,m)};B(l,u=>{(n()||o())&&u(p)})}var f=I(l,2),k=I(f,2);A(v),q("click",f,()=>c()),q("click",k,()=>_r()),L(r,v),X(),a()}var Sr=w("<!> <!> <!>",1);function Rr(r){const[e,t]=ee(),a=()=>P(W,"$selectedPage",e);var n=Sr(),o=U(n);gr(o,{});var s=I(o,2);pr(s);var i=I(s,2);{var c=v=>{Lr(v,{})};B(i,v=>{a()==="settings"&&v(c)})}L(r,n),t()}export{Rr as component};
