import{t as S,a as I,c as oe}from"../chunks/CyOrqUXm.js";import{i as re}from"../chunks/CL0QEqD9.js";import{A as J,l as B,a0 as Le,$ as Be,x as Ce,i as $e,g as E,N as X,y as Re,z as ie,B as G,m as z,ad as Ve,C as me,j as be,D as Oe,ah as Ae,a8 as Me,F,ap as le,aq as K,a2 as ve,ar as Te,as as ze,at as Pe,ag as je,au as De,k as Fe,av as Ue,aw as He,ab as Ye,ax as Je,ay as Ge,az as Ke,aA as qe,aj as Ne,aB as We,p as te,s as b,v as h,w,t as V,q as ne,J as q,o as U,aC as Qe,aD as W}from"../chunks/DZpqQ712.js";import{p as ce,i as L,s as j,a as se,b as Ze}from"../chunks/B8VvTqyC.js";import{o as Xe,w as H,g as fe}from"../chunks/HU1d89I3.js";import{l as ea,e as ee,s as T}from"../chunks/DUnFqAGD.js";function ue(r,e){return e}function aa(r,e,a,t){for(var n=[],s=e.length,o=0;o<s;o++)Pe(e[o].e,n,!0);var i=s>0&&n.length===0&&a!==null;if(i){var c=a.parentNode;je(c),c.append(a),t.clear(),R(r,e[0].prev,e[s-1].next)}De(n,()=>{for(var p=0;p<s;p++){var v=e[p];i||(t.delete(v.k),R(r,v.prev,v.next)),Fe(v.e,!i)}})}function de(r,e,a,t,n,s=null){var o=r,i={flags:e,items:new Map,first:null};{var c=r;o=B?J(Le(c)):c.appendChild(Be())}B&&Ce();var p=null,v=!1,_=X(()=>{var k=a();return Me(k)?k:k==null?[]:Ae(k)});$e(()=>{var k=E(_),u=k.length;if(v&&u===0)return;v=u===0;let d=!1;if(B){var m=o.data===Re;m!==(u===0)&&(o=ie(),J(o),G(!1),d=!0)}if(B){for(var g=null,l,f=0;f<u;f++){if(z.nodeType===8&&z.data===Ve){o=z,d=!0,G(!1);break}var A=k[f],N=t(A,f);l=Ie(z,i,g,null,A,N,f,n,e,a),i.items.set(N,l),g=l}u>0&&J(ie())}B||ra(k,i,o,n,e,t,a),s!==null&&(u===0?p?me(p):p=be(()=>s(o)):p!==null&&Oe(p,()=>{p=null})),d&&G(!0),E(_)}),B&&(o=z)}function ra(r,e,a,t,n,s,o){var i=r.length,c=e.items,p=e.first,v=p,_,k=null,u=[],d=[],m,g,l,f;for(f=0;f<i;f+=1){if(m=r[f],g=s(m,f),l=c.get(g),l===void 0){var A=v?v.e.nodes_start:a;k=Ie(A,e,k,k===null?e.first:k.next,m,g,f,t,n,o),c.set(g,k),u=[],d=[],v=k.next;continue}if(ta(l,m,f),(l.e.f&K)!==0&&me(l.e),l!==v){if(_!==void 0&&_.has(l)){if(u.length<d.length){var N=d[0],x;k=N.prev;var O=u[0],y=u[u.length-1];for(x=0;x<u.length;x+=1)pe(u[x],N,a);for(x=0;x<d.length;x+=1)_.delete(d[x]);R(e,O.prev,y.next),R(e,k,O),R(e,y,N),v=N,k=y,f-=1,u=[],d=[]}else _.delete(l),pe(l,v,a),R(e,l.prev,l.next),R(e,l,k===null?e.first:k.next),R(e,k,l),k=l;continue}for(u=[],d=[];v!==null&&v.k!==g;)(v.e.f&K)===0&&(_??(_=new Set)).add(v),d.push(v),v=v.next;if(v===null)continue;l=v}u.push(l),k=l,v=l.next}if(v!==null||_!==void 0){for(var C=_===void 0?[]:Ae(_);v!==null;)(v.e.f&K)===0&&C.push(v),v=v.next;var $=C.length;if($>0){var M=i===0?a:null;aa(e,C,M,c)}}ve.first=e.first&&e.first.e,ve.last=k&&k.e}function ta(r,e,a,t){ze(r.v,e),r.i=a}function Ie(r,e,a,t,n,s,o,i,c,p){var v=(c&Ue)!==0,_=(c&He)===0,k=v?_?F(n):le(n):n,u=(c&Te)===0?o:le(o),d={i:u,v:k,k:s,a:null,e:null,prev:a,next:t};try{return d.e=be(()=>i(r,k,u,p),B),d.e.prev=a&&a.e,d.e.next=t&&t.e,a===null?e.first=d:(a.next=d,a.e.next=d.e),t!==null&&(t.prev=d,t.e.prev=d.e),d}finally{}}function pe(r,e,a){for(var t=r.next?r.next.e.nodes_start:a,n=e?e.e.nodes_start:a,s=r.e.nodes_start;s!==t;){var o=Ye(s);n.before(s),s=o}}function R(r,e,a){e===null?r.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}const ke=[...` 	
\r\fÂ \v\uFEFF`];function na(r,e,a){var t=""+r;if(a){for(var n in a)if(a[n])t=t?t+" "+n:n;else if(t.length)for(var s=n.length,o=0;(o=t.indexOf(n,o))>=0;){var i=o+s;(o===0||ke.includes(t[o-1]))&&(i===t.length||ke.includes(t[i]))?t=(o===0?"":t.substring(0,o))+t.substring(i+1):o=i}}return t===""?null:t}function sa(r,e,a,t,n,s){var o=r.__className;if(B||o!==a||o===void 0){var i=na(a,t,s);(!B||i!==r.getAttribute("class"))&&(i==null?r.removeAttribute("class"):r.className=i),r.__className=a}else if(s&&n!==s)for(var c in s){var p=!!s[c];(n==null||p!==!!n[c])&&r.classList.toggle(c,p)}return s}const oa=Symbol("is custom element"),ia=Symbol("is html");function P(r,e,a,t){var n=la(r);B&&(n[e]=r.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&r.nodeName==="LINK")||n[e]!==(n[e]=a)&&(e==="loading"&&(r[Ge]=a),a==null?r.removeAttribute(e):typeof a!="string"&&va(r).includes(e)?r[e]=a:r.setAttribute(e,a))}function la(r){return r.__attributes??(r.__attributes={[oa]:r.nodeName.includes("-"),[ia]:r.namespaceURI===Je})}var ge=new Map;function va(r){var e=ge.get(r.nodeName);if(e)return e;ge.set(r.nodeName,e=[]);for(var a,t=r,n=Element.prototype;n!==t;){a=qe(t);for(var s in a)a[s].set&&e.push(s);t=Ke(t)}return e}function Ee(r,e,a){if(r.multiple)return ua(r,e);for(var t of r.options){var n=D(t);if(We(n,e)){t.selected=!0;return}}(!a||e!==void 0)&&(r.selectedIndex=-1)}function ca(r,e){Ne(()=>{var a=new MutationObserver(()=>{var t=r.__value;Ee(r,t)});return a.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{a.disconnect()}})}function fa(r,e,a=e){var t=!0;ea(r,"change",n=>{var s=n?"[selected]":":checked",o;if(r.multiple)o=[].map.call(r.querySelectorAll(s),D);else{var i=r.querySelector(s)??r.querySelector("option:not([disabled])");o=i&&D(i)}a(o)}),Ne(()=>{var n=e();if(Ee(r,n,t),t&&n===void 0){var s=r.querySelector(":checked");s!==null&&(n=D(s),a(n))}r.__value=n,t=!1}),ca(r)}function ua(r,e){for(var a of r.options)a.selected=~e.indexOf(D(a))}function D(r){return"__value"in r?r.__value:r.value}const xe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAAAAACPAi4CAAABH0lEQVRYw2NgGAVUArGNZIBYJAPa/pMB2kYNGDVg1IBRA0YNGDVg1IARacCO6KQdFBjwcpI1C6v11JfkGvC4QoWFgYFFvfoxmQYkCTGBJJmE48ky4KoNM0ya2eoqyQbc7VNnRMgzak68S5oBZzNlGJHbgYwy6WdJMWCvpyB6U1LA8xDxBszUYsNsjLLpzCHWgFoJRmzNWUbxSqIMOBLPj6tFzBd7hLABi5zYcbep2Z3nEzDgZaUmE75WOaN62WN8BhyPEiPUsBeLPoXbgEOunIS7BhxO+3EY8HKDAXG9C811L7EZcLxYnNj+iVjBEUwD1vnzE9/D4fNeiW7AfFNOUvpIHEazUA3ok2QmrZfFLN6JbIAdC+kdNRa70c4qtQAA7m/LhSePmzgAAAAASUVORK5CYII=",we={faviconSize:128,faviconFetchServiceURL:r=>`https://t2.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${r}&size=${we.faviconSize}`};async function da(){const e="/bk"+"/bookmarks";try{const a=await fetch(e+"/index.json");if(a){const t=await a.json();if(Array.isArray(t)?t.length>0:!1){const o=t.sort().map(i=>fetch(e+"/"+i+".json").then(c=>c.json()).then(c=>(c.bookmarkIndexName=i,c)));return await Promise.all(o)}}}catch(a){console.error("bookmarks folder or bookmarks/index.json not found. Error:",a)}}async function pa(r){const e={};if(Array.isArray(r)?r.length>0:!1)for(let t=0;t<r.length;t++){const n=r[t],s=n.LINK,o=n.ICON;let i="";if(o)i=o;else if(s){const c=new URL(s),p=c.protocol+"//"+c.hostname;i=we.faviconFetchServiceURL(p)}else i=xe;n.bookmarkIndexName&&(e[n.bookmarkIndexName]=i)}return e}var ka=S('<div class="bk-meta-info svelte-1jzx7ns"><div class="bk-name svelte-1jzx7ns"> </div> <div class="bk-link svelte-1jzx7ns"> </div></div>'),ga=S('<div class="bk-title svelte-1jzx7ns"> </div>'),ha=S('<div class="bk-desc svelte-1jzx7ns"> </div>'),_a=S('<a class="bk svelte-1jzx7ns" target="_blank" rel="noopener noreferrer"><div class="bk-meta svelte-1jzx7ns"><div class="bk-icon svelte-1jzx7ns"><img class="bk-icon-img svelte-1jzx7ns" alt="icon" width="100%" height="100%" loading="lazy"></div> <!></div> <!> <!></a>');function he(r,e){te(e,!1);let a=ce(e,"bookmark",8),t=ce(e,"faviconLink",8);const n=a().LINK||"javascript:void(0)";let s=a().NAME||a().LINK;function o(l){const f=l==null?void 0:l.target;f&&(f.src=xe)}re();var i=_a();P(i,"href",n),P(i,"title",s);var c=b(i),p=b(c),v=b(p);h(p);var _=w(p,2);{var k=l=>{var f=ka(),A=b(f),N=b(A,!0);h(A);var x=w(A,2),O=b(x,!0);h(x),h(f),V(()=>{T(N,a().NAME),T(O,a().LINK)}),I(l,f)};L(_,l=>{a().IS_PINNED||l(k)})}h(c);var u=w(c,2);{var d=l=>{var f=ga(),A=b(f,!0);h(f),V(()=>T(A,a().TITLE)),I(l,f)};L(u,l=>{a().TITLE&&l(d)})}var m=w(u,2);{var g=l=>{var f=ha(),A=b(f,!0);h(f),V(()=>T(A,a().DESC)),I(l,f)};L(m,l=>{a().DESC&&l(g)})}h(i),V(()=>{P(i,"data-bookmark-icon",a().ICON),P(v,"src",t())}),ee("error",v,o),I(r,i),ne()}var ma=S('<div class="bk-container-pinned svelte-1uu4y0a"></div>'),ba=S('<div class="bk-container-grid svelte-1uu4y0a"></div>'),Aa=S('<div class="bk-wrapper svelte-1uu4y0a"><div class="bk-container svelte-1uu4y0a"><!> <!></div></div>');function Na(r,e){te(e,!1);let a=[],t=F([]),n=F([]),s=F({});async function o(){const u=await da();u&&(a=u.sort((m,g)=>m.NAME.localeCompare(g.NAME)),q(t,a.filter(m=>m.IS_PINNED)),q(n,a.filter(m=>!m.IS_PINNED)))}Xe(async()=>{await o();const u=await pa(a);u&&q(s,u)}),re();var i=Aa(),c=b(i),p=b(c);{var v=u=>{var d=ma();de(d,5,()=>E(t),ue,(m,g)=>{var l=oe(),f=U(l);{var A=N=>{he(N,{get bookmark(){return E(g)},get faviconLink(){return E(s)[E(g).bookmarkIndexName]}})};L(f,N=>{E(g).bookmarkIndexName&&N(A)})}I(m,l)}),h(d),I(u,d)};L(p,u=>{E(t).length>0&&u(v)})}var _=w(p,2);{var k=u=>{var d=ba();de(d,5,()=>E(n),ue,(m,g)=>{var l=oe(),f=U(l);{var A=N=>{he(N,{get bookmark(){return E(g)},get faviconLink(){return E(s)[E(g).bookmarkIndexName]}})};L(f,N=>{E(g).bookmarkIndexName&&N(A)})}I(m,l)}),h(d),I(u,d)};L(_,u=>{E(n).length>0&&u(k)})}h(c),h(i),I(r,i),ne()}const ae=H("home"),Q=H(null),Z=H(null);var Ia=S('<div class="header svelte-1elv7ik"><a class="brand svelte-1elv7ik"></a> <select class="view-list svelte-1elv7ik" id="view-list"><option>Home</option><option>Settings</option></select></div>');function Ea(r){const[e,a]=se(),t=()=>j(ae,"$selectedPage",e),n="https://m9j.github.io/bk";var s=Ia(),o=b(s);P(o,"href",n),o.textContent="BOOKMARKS";var i=w(o,2);V(()=>{t(),Qe(()=>{})});var c=b(i);c.value=c.__value="home";var p=w(c);p.value=p.__value="settings",h(i),h(s),fa(i,t,v=>Ze(ae,v)),I(r,s),a()}function xa(){navigator.serviceWorker.getRegistrations().then(r=>{r.forEach(e=>e.unregister()),console.log("All service workers have been unregistered."),caches.keys().then(e=>Promise.all(e.map(a=>caches.delete(a)))).then(()=>{console.log("All caches have been cleared."),location.reload()})})}function _e(r){if(r){const e=new Date(Number(r)),a=String(e.getFullYear()),t=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),o=String(e.getMinutes()).padStart(2,"0"),i=String(e.getSeconds()).padStart(2,"0");return`${a}.${t}${n}.${s}${o}${i}`}}async function wa(){const e="/bk"+"/version.json";try{const a=await fetch(e);if(!a.ok)console.log(new Error("Failed to fetch current version"));else return(await a.json()).version}catch(a){console.error("Current version check failed: ",a)}}async function Sa(){const r="https://api.github.com/repos/m9j/bk/contents/version.json?ref=gh-pages";try{const e=await fetch(r,{cache:"no-store"});if(!e.ok)console.log(new Error("Failed to fetch latest version"));else{const a=await e.json();return JSON.parse(atob(a.content)).version}}catch(e){console.error("Latest version check failed: ",e)}}var ya=S('<span class="monospace svelte-1kpux3b"> </span> <br>',1),La=S("<span> </span><br>",1),Ba=S("<div>Versions:<br> <!> <!></div>"),Ca=S('<div class="settings-container hide svelte-1kpux3b" id="settings-container"><div class="columns svelte-1kpux3b"><!></div> <div class="rows svelte-1kpux3b"><button class="settings-button svelte-1kpux3b">Check for latest version</button> <button class="settings-button svelte-1kpux3b">Hard reload application</button></div> <br> <div class="columns svelte-1kpux3b"><div>Repo deploy status:</div> <div><img src="https://github.com/m9j/bk/actions/workflows/deploy.yml/badge.svg" alt="Github Deploy Status"></div></div></div>');function $a(r,e){te(e,!1);const[a,t]=se(),n=()=>j(Q,"$currentVersion",a),s=()=>j(Z,"$latestVersion",a),o=()=>j(i,"$isNew",a),i=H(!1);(async()=>(await c(),await p()))();async function c(){const l=await wa();Q.update(f=>l)}async function p(){const l=await Sa();Z.update(f=>l),i.update(f=>Number(fe(Z))>Number(fe(Q)))}re();var v=Ca(),_=b(v),k=b(_);{var u=l=>{var f=Ba(),A=w(b(f),3);{var N=y=>{var C=ya(),$=U(C),M=b($);h($),W(2),V(Y=>T(M,`${Y??""} [CURRENT]`),[()=>_e(n())],X),I(y,C)};L(A,y=>{n()&&y(N)})}var x=w(A,2);{var O=y=>{var C=La(),$=U(C);let M;var Y=b($);h($),W(),V((Se,ye)=>{M=sa($,1,"monospace svelte-1kpux3b",null,M,Se),T(Y,`${ye??""} [LATEST]`)},[()=>({"is-new":o()}),()=>_e(s())],X),I(y,C)};L(x,y=>{s()&&y(O)})}h(f),I(l,f)};L(k,l=>{(n()||s())&&l(u)})}h(_);var d=w(_,2),m=b(d),g=w(m,2);h(d),W(4),h(v),ee("click",m,()=>p()),ee("click",g,()=>xa()),I(r,v),ne(),t()}var Ra=S('<div class="app-wrapper svelte-jtpawk"><!> <div class="app-bottom-wrapper svelte-jtpawk"><!> <!></div></div>');function ja(r){const[e,a]=se(),t=()=>j(ae,"$selectedPage",e);var n=Ra(),s=b(n);Na(s,{});var o=w(s,2),i=b(o);Ea(i);var c=w(i,2);{var p=v=>{$a(v,{})};L(c,v=>{t()==="settings"&&v(p)})}h(o),h(n),I(r,n),a()}export{ja as component};
