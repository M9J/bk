import{t as L,a as x,c as re}from"../chunks/CyOrqUXm.js";import{i as J}from"../chunks/CL0QEqD9.js";import{A as Q,l as $,a0 as $e,$ as Ce,x as Be,i as Re,g as y,N as se,y as Ve,z as ce,B as Z,m as z,ad as Me,C as be,j as ke,D as Oe,ah as Ae,a8 as Pe,F as U,ap as ve,aq as X,a2 as de,ar as Te,as as Fe,at as je,ag as ze,au as De,k as Ue,av as He,aw as Ye,ab as Je,ax as Ge,ay as Ke,az as qe,aA as We,aj as Ne,aB as Qe,p as G,s as k,v as b,w as I,t as V,q as K,J as Y,o as F,aC as Ze,aD as ee}from"../chunks/DZpqQ712.js";import{p as fe,i as w,s as T,a as q,b as Xe}from"../chunks/B8VvTqyC.js";import{o as xe,w as j,g as ue}from"../chunks/HU1d89I3.js";import{l as ea,e as ne,s as M}from"../chunks/DUnFqAGD.js";function oe(t,e){return e}function aa(t,e,a,r){for(var s=[],n=e.length,o=0;o<n;o++)je(e[o].e,s,!0);var l=n>0&&s.length===0&&a!==null;if(l){var u=a.parentNode;ze(u),u.append(a),r.clear(),R(t,e[0].prev,e[n-1].next)}De(s,()=>{for(var m=0;m<n;m++){var d=e[m];l||(r.delete(d.k),R(t,d.prev,d.next)),Ue(d.e,!l)}})}function ie(t,e,a,r,s,n=null){var o=t,l={flags:e,items:new Map,first:null};{var u=t;o=$?Q($e(u)):u.appendChild(Ce())}$&&Be();var m=null,d=!1,p=se(()=>{var c=a();return Pe(c)?c:c==null?[]:Ae(c)});Re(()=>{var c=y(p),v=c.length;if(d&&v===0)return;d=v===0;let f=!1;if($){var g=o.data===Ve;g!==(v===0)&&(o=ce(),Q(o),Z(!1),f=!0)}if($){for(var _=null,i,h=0;h<v;h++){if(z.nodeType===8&&z.data===Me){o=z,f=!0,Z(!1);break}var A=c[h],N=r(A,h);i=ye(z,l,_,null,A,N,h,s,e,a),l.items.set(N,i),_=i}v>0&&Q(ce())}$||ta(c,l,o,s,e,r,a),n!==null&&(v===0?m?be(m):m=ke(()=>n(o)):m!==null&&Oe(m,()=>{m=null})),f&&Z(!0),y(p)}),$&&(o=z)}function ta(t,e,a,r,s,n,o){var l=t.length,u=e.items,m=e.first,d=m,p,c=null,v=[],f=[],g,_,i,h;for(h=0;h<l;h+=1){if(g=t[h],_=n(g,h),i=u.get(_),i===void 0){var A=d?d.e.nodes_start:a;c=ye(A,e,c,c===null?e.first:c.next,g,_,h,r,s,o),u.set(_,c),v=[],f=[],d=c.next;continue}if(ra(i,g,h),(i.e.f&X)!==0&&be(i.e),i!==d){if(p!==void 0&&p.has(i)){if(v.length<f.length){var N=f[0],E;c=N.prev;var O=v[0],S=v[v.length-1];for(E=0;E<v.length;E+=1)he(v[E],N,a);for(E=0;E<f.length;E+=1)p.delete(f[E]);R(e,O.prev,S.next),R(e,c,O),R(e,S,N),d=N,c=S,h-=1,v=[],f=[]}else p.delete(i),he(i,d,a),R(e,i.prev,i.next),R(e,i,c===null?e.first:c.next),R(e,c,i),c=i;continue}for(v=[],f=[];d!==null&&d.k!==_;)(d.e.f&X)===0&&(p??(p=new Set)).add(d),f.push(d),d=d.next;if(d===null)continue;i=d}v.push(i),c=i,d=i.next}if(d!==null||p!==void 0){for(var C=p===void 0?[]:Ae(p);d!==null;)(d.e.f&X)===0&&C.push(d),d=d.next;var B=C.length;if(B>0){var P=l===0?a:null;aa(e,C,P,u)}}de.first=e.first&&e.first.e,de.last=c&&c.e}function ra(t,e,a,r){Fe(t.v,e),t.i=a}function ye(t,e,a,r,s,n,o,l,u,m){var d=(u&He)!==0,p=(u&Ye)===0,c=d?p?U(s):ve(s):s,v=(u&Te)===0?o:ve(o),f={i:v,v:c,k:n,a:null,e:null,prev:a,next:r};try{return f.e=ke(()=>l(t,c,v,m),$),f.e.prev=a&&a.e,f.e.next=r&&r.e,a===null?e.first=f:(a.next=f,a.e.next=f.e),r!==null&&(r.prev=f,r.e.prev=f.e),f}finally{}}function he(t,e,a){for(var r=t.next?t.next.e.nodes_start:a,s=e?e.e.nodes_start:a,n=t.e.nodes_start;n!==r;){var o=Je(n);s.before(n),n=o}}function R(t,e,a){e===null?t.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}const me=[...` 	
\r\fÂ \v\uFEFF`];function sa(t,e,a){var r=""+t;if(a){for(var s in a)if(a[s])r=r?r+" "+s:s;else if(r.length)for(var n=s.length,o=0;(o=r.indexOf(s,o))>=0;){var l=o+n;(o===0||me.includes(r[o-1]))&&(l===r.length||me.includes(r[l]))?r=(o===0?"":r.substring(0,o))+r.substring(l+1):o=l}}return r===""?null:r}function na(t,e,a,r,s,n){var o=t.__className;if($||o!==a||o===void 0){var l=sa(a,r,n);(!$||l!==t.getAttribute("class"))&&(l==null?t.removeAttribute("class"):t.className=l),t.__className=a}else if(n&&s!==n)for(var u in n){var m=!!n[u];(s==null||m!==!!s[u])&&t.classList.toggle(u,m)}return n}const oa=Symbol("is custom element"),ia=Symbol("is html");function D(t,e,a,r){var s=la(t);$&&(s[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||s[e]!==(s[e]=a)&&(e==="loading"&&(t[Ke]=a),a==null?t.removeAttribute(e):typeof a!="string"&&ca(t).includes(e)?t[e]=a:t.setAttribute(e,a))}function la(t){return t.__attributes??(t.__attributes={[oa]:t.nodeName.includes("-"),[ia]:t.namespaceURI===Ge})}var ge=new Map;function ca(t){var e=ge.get(t.nodeName);if(e)return e;ge.set(t.nodeName,e=[]);for(var a,r=t,s=Element.prototype;s!==r;){a=We(r);for(var n in a)a[n].set&&e.push(n);r=qe(r)}return e}function Ie(t,e,a){if(t.multiple)return fa(t,e);for(var r of t.options){var s=H(r);if(Qe(s,e)){r.selected=!0;return}}(!a||e!==void 0)&&(t.selectedIndex=-1)}function va(t,e){Ne(()=>{var a=new MutationObserver(()=>{var r=t.__value;Ie(t,r)});return a.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{a.disconnect()}})}function da(t,e,a=e){var r=!0;ea(t,"change",s=>{var n=s?"[selected]":":checked",o;if(t.multiple)o=[].map.call(t.querySelectorAll(n),H);else{var l=t.querySelector(n)??t.querySelector("option:not([disabled])");o=l&&H(l)}a(o)}),Ne(()=>{var s=e();if(Ie(t,s,r),r&&s===void 0){var n=t.querySelector(":checked");n!==null&&(s=H(n),a(s))}t.__value=s,r=!1}),va(t)}function fa(t,e){for(var a of t.options)a.selected=~e.indexOf(H(a))}function H(t){return"__value"in t?t.__value:t.value}const Le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAAAAACPAi4CAAABH0lEQVRYw2NgGAVUArGNZIBYJAPa/pMB2kYNGDVg1IBRA0YNGDVg1IARacCO6KQdFBjwcpI1C6v11JfkGvC4QoWFgYFFvfoxmQYkCTGBJJmE48ky4KoNM0ya2eoqyQbc7VNnRMgzak68S5oBZzNlGJHbgYwy6WdJMWCvpyB6U1LA8xDxBszUYsNsjLLpzCHWgFoJRmzNWUbxSqIMOBLPj6tFzBd7hLABi5zYcbep2Z3nEzDgZaUmE75WOaN62WN8BhyPEiPUsBeLPoXbgEOunIS7BhxO+3EY8HKDAXG9C811L7EZcLxYnNj+iVjBEUwD1vnzE9/D4fNeiW7AfFNOUvpIHEazUA3ok2QmrZfFLN6JbIAdC+kdNRa70c4qtQAA7m/LhSePmzgAAAAASUVORK5CYII=",Ee={faviconSize:128,faviconFetchServiceURL:t=>`https://t2.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${t}&size=${Ee.faviconSize}`};async function ua(){const e="/bk"+"/bookmarks";try{const a=await fetch(e+"/index.json");if(a){const r=await a.json();if(Array.isArray(r)?r.length>0:!1){const o=r.sort().map(l=>fetch(e+"/"+l+".json").then(u=>u.json()).then(u=>(u.bookmarkIndexName=l,u)));return await Promise.all(o)}}}catch(a){console.error("bookmarks folder or bookmarks/index.json not found. Error:",a)}}async function ha(t){const e={};if(Array.isArray(t)?t.length>0:!1)for(let r=0;r<t.length;r++){const s=t[r],n=s.LINK,o=s.ICON;let l="";if(o)l=o;else if(n){const u=new URL(n),m=u.protocol+"//"+u.hostname;l=Ee.faviconFetchServiceURL(m)}else l=Le;s.bookmarkIndexName&&(e[s.bookmarkIndexName]=l)}return e}var ma=L('<div class="bk-meta-info svelte-1jzx7ns"><div class="bk-name svelte-1jzx7ns"> </div> <div class="bk-link svelte-1jzx7ns"> </div></div>'),ga=L('<div class="bk-title svelte-1jzx7ns"> </div>'),pa=L('<div class="bk-desc svelte-1jzx7ns"> </div>'),_a=L('<a class="bk svelte-1jzx7ns" target="_blank" rel="noopener noreferrer"><div class="bk-meta svelte-1jzx7ns"><div class="bk-icon svelte-1jzx7ns"><img class="bk-icon-img svelte-1jzx7ns" alt="icon" width="100%" height="100%" loading="lazy"></div> <!></div> <!> <!></a>');function pe(t,e){G(e,!1);let a=fe(e,"bookmark",8),r=fe(e,"faviconLink",8);const s=a().LINK||"javascript:void(0)";let n=a().NAME||a().LINK;function o(i){const h=i==null?void 0:i.target;h&&(h.src=Le)}J();var l=_a();D(l,"href",s),D(l,"title",n);var u=k(l),m=k(u),d=k(m);b(m);var p=I(m,2);{var c=i=>{var h=ma(),A=k(h),N=k(A,!0);b(A);var E=I(A,2),O=k(E,!0);b(E),b(h),V(()=>{M(N,a().NAME),M(O,a().LINK)}),x(i,h)};w(p,i=>{a().IS_PINNED||i(c)})}b(u);var v=I(u,2);{var f=i=>{var h=ga(),A=k(h,!0);b(h),V(()=>M(A,a().TITLE)),x(i,h)};w(v,i=>{a().TITLE&&i(f)})}var g=I(v,2);{var _=i=>{var h=pa(),A=k(h,!0);b(h),V(()=>M(A,a().DESC)),x(i,h)};w(g,i=>{a().DESC&&i(_)})}b(l),V(()=>{D(l,"data-bookmark-icon",a().ICON),D(d,"src",r())}),ne("error",d,o),x(t,l),K()}var ba=L('<div class="bk-container-pinned svelte-1uu4y0a"></div>'),ka=L('<div class="bk-container-grid svelte-1uu4y0a"></div>'),Aa=L('<div class="bk-wrapper svelte-1uu4y0a"><div class="bk-container svelte-1uu4y0a"><!> <!></div></div>');function Na(t,e){G(e,!1);let a=[],r=U([]),s=U([]),n=U({});async function o(){const v=await ua();v&&(a=v.sort((g,_)=>g.NAME.localeCompare(_.NAME)),Y(r,a.filter(g=>g.IS_PINNED)),Y(s,a.filter(g=>!g.IS_PINNED)))}xe(async()=>{await o();const v=await ha(a);v&&Y(n,v)}),J();var l=Aa(),u=k(l),m=k(u);{var d=v=>{var f=ba();ie(f,5,()=>y(r),oe,(g,_)=>{var i=re(),h=F(i);{var A=N=>{pe(N,{get bookmark(){return y(_)},get faviconLink(){return y(n)[y(_).bookmarkIndexName]}})};w(h,N=>{y(_).bookmarkIndexName&&N(A)})}x(g,i)}),b(f),x(v,f)};w(m,v=>{y(r).length>0&&v(d)})}var p=I(m,2);{var c=v=>{var f=ka();ie(f,5,()=>y(s),oe,(g,_)=>{var i=re(),h=F(i);{var A=N=>{pe(N,{get bookmark(){return y(_)},get faviconLink(){return y(n)[y(_).bookmarkIndexName]}})};w(h,N=>{y(_).bookmarkIndexName&&N(A)})}x(g,i)}),b(f),x(v,f)};w(p,v=>{y(s).length>0&&v(c)})}b(u),b(l),x(t,l),K()}const le=j("home"),ae=j(null),te=j(null);var xa=L('<hr class="separator svelte-obx2py">'),ya=L('<div class="header svelte-obx2py"><a class="brand svelte-obx2py"></a> <select class="view-list svelte-obx2py" id="view-list"><option>Home</option><option>Settings</option></select></div> <!>',1);function Ia(t){const[e,a]=q(),r=()=>T(le,"$selectedPage",e),s="https://m9j.github.io/bk";var n=ya(),o=F(n),l=k(o);D(l,"href",s),l.textContent="BOOKMARKS";var u=I(l,2);V(()=>{r(),Ze(()=>{})});var m=k(u);m.value=m.__value="home";var d=I(m);d.value=d.__value="settings",b(u),b(o);var p=I(o,2);{var c=v=>{var f=xa();x(v,f)};w(p,v=>{r()!=="home"&&v(c)})}da(u,r,v=>Xe(le,v)),x(t,n),a()}async function La(t){if(t){let e=setTimeout(()=>{clearTimeout(e),t()},0)}}async function Ea(){const e="/bk"+"/lambdas";try{const a=await fetch(e+"/index.json");if(a){const r=await a.json();if(Array.isArray(r)?r.length>0:!1){const n=r.map(o=>import(e+"/"+o+".lambda.js"));return await Promise.all(n)}}}catch(a){console.error("lambdas folder or lambdas/index.json not found. Error:",a)}}var wa=L('<div class="lambda svelte-vmgkgn"><div class="lambda-title"> <span class="lambda-result"> </span></div></div>'),Sa=L('<div class="lambdas-container svelte-vmgkgn"></div>');function $a(t,e){G(e,!1);const[a,r]=q(),s=()=>T(o,"$results",a);let n=U([]);const o=j([]);xe(async()=>{const c=await Ea();if(c&&(Array.isArray(c)?c.length>0:!1)){const f=[];for(const g of c)f.push({...g,result:j("")});Y(n,f),l(y(n))}});async function l(c){if(Array.isArray(c)?c.length>0:!1)for(const[f,g]of Object.entries(c))u(g,Number(f))}async function u(c,v){La(async()=>{if(c.action&&typeof c.action=="function"){const f=_=>{o.update(i=>(i[v]=_,i))},g=await c.action(f);g&&f(g)}})}J();var m=re(),d=F(m);{var p=c=>{var v=Sa();ie(v,5,()=>y(n),oe,(f,g,_)=>{var i=wa(),h=k(i),A=k(h),N=I(A),E=k(N,!0);b(N),b(h),b(i),V(()=>{M(A,`${y(g).prompt??""}: `),M(E,s()[_]??"...")}),x(f,i)}),b(v),x(c,v)};w(d,c=>{y(n).length>0&&c(p)})}x(t,m),K(),r()}function Ca(){navigator.serviceWorker.getRegistrations().then(t=>{t.forEach(e=>e.unregister()),console.log("All service workers have been unregistered."),caches.keys().then(e=>Promise.all(e.map(a=>caches.delete(a)))).then(()=>{console.log("All caches have been cleared."),location.reload()})})}function _e(t){if(t){const e=new Date(Number(t)),a=String(e.getFullYear()),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),n=String(e.getHours()).padStart(2,"0"),o=String(e.getMinutes()).padStart(2,"0"),l=String(e.getSeconds()).padStart(2,"0");return`${a}.${r}${s}.${n}${o}${l}`}}async function Ba(){const e="/bk"+"/version.json";try{const a=await fetch(e);if(!a.ok)console.log(new Error("Failed to fetch current version"));else return(await a.json()).version}catch(a){console.error("Current version check failed: ",a)}}async function Ra(){const t="https://api.github.com/repos/m9j/bk/contents/version.json?ref=gh-pages";try{const e=await fetch(t,{cache:"no-store"});if(!e.ok)console.log(new Error("Failed to fetch latest version"));else{const a=await e.json();return JSON.parse(atob(a.content)).version}}catch(e){console.error("Latest version check failed: ",e)}}var Va=L('<span class="monospace svelte-2le08x"> </span> <br>',1),Ma=L("<span> </span><br>",1),Oa=L("<div>Versions:<br> <!> <!></div>"),Pa=L('<div class="settings-container hide svelte-2le08x" id="settings-container"><div class="columns svelte-2le08x"><!></div> <div class="rows svelte-2le08x"><button class="settings-button svelte-2le08x">Check for latest version</button> <button class="settings-button svelte-2le08x">Hard reload application</button></div> <br> <div class="columns svelte-2le08x"><div>Repo deploy status:</div> <div><img src="https://github.com/m9j/bk/actions/workflows/deploy.yml/badge.svg" alt="Github Deploy Status"></div></div></div>');function Ta(t,e){G(e,!1);const[a,r]=q(),s=()=>T(ae,"$currentVersion",a),n=()=>T(te,"$latestVersion",a),o=()=>T(l,"$isNew",a),l=j(!1);(async()=>(await u(),await m()))();async function u(){const i=await Ba();ae.update(h=>i)}async function m(){const i=await Ra();te.update(h=>i),l.update(h=>Number(ue(te))>Number(ue(ae)))}J();var d=Pa(),p=k(d),c=k(p);{var v=i=>{var h=Oa(),A=I(k(h),3);{var N=S=>{var C=Va(),B=F(C),P=k(B);b(B),ee(2),V(W=>M(P,`${W??""} [CURRENT]`),[()=>_e(s())],se),x(S,C)};w(A,S=>{s()&&S(N)})}var E=I(A,2);{var O=S=>{var C=Ma(),B=F(C);let P;var W=k(B);b(B),ee(),V((we,Se)=>{P=na(B,1,"monospace svelte-2le08x",null,P,we),M(W,`${Se??""} [LATEST]`)},[()=>({"is-new":o()}),()=>_e(n())],se),x(S,C)};w(E,S=>{n()&&S(O)})}b(h),x(i,h)};w(c,i=>{(s()||n())&&i(v)})}b(p);var f=I(p,2),g=k(f),_=I(g,2);b(f),ee(4),b(d),ne("click",g,()=>m()),ne("click",_,()=>Ca()),x(t,d),K(),r()}var Fa=L('<div class="app-wrapper svelte-lehtuv"><!> <!> <div class="app-bottom-wrapper svelte-lehtuv"><!> <!></div></div>');function Ja(t){const[e,a]=q(),r=()=>T(le,"$selectedPage",e);var s=Fa(),n=k(s);Na(n,{});var o=I(n,2);$a(o,{});var l=I(o,2),u=k(l);Ia(u);var m=I(u,2);{var d=p=>{Ta(p,{})};w(m,p=>{r()==="settings"&&p(d)})}b(l),b(s),x(t,s),a()}export{Ja as component};
